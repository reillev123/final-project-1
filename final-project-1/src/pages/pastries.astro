---
import Layout from '../layouts/Layouts.astro';
---
<!-- Creating a Pastry recipes page -->
<Layout>
    <!-- Set the page title -->
    <title>Pastry Recipes</title>
    <!-- Main container with centered text and margin-top -->
    <div class="container text-center mt-5">
        <h2>Our Favorite Pastry Recipes</h2>
        <p>Discover our collection of delightful bakery recipes that you can make at home.</p>
    </div>
    <!-- Spinner wrapper to show loading indicator -->
    <div class="spinner-wrapper">
        <div id="spinner" class="spinner-border" role="status" style="display: none;">
            <span class="sr-only">Loading...</span>
        </div>
    </div>
    <!-- Container for recipes with Bootstrap row class -->
    <div id="recipes-container" class="row"></div> <!-- Add Bootstrap row class -->

    <script>
        // Async function to fetch pastry recipes from the API
        async function fetchRecipes() {
            // Construct the API URL with query parameters for pastry recipes
            const fullURL = "https://api.edamam.com/api/recipes/v2?type=public&beta=true&q=%22pastry%22&app_id=d7193a6c&app_key=c9b8ee8a1b8166ef57bc491438a36768&dishType=Desserts";
            
            try {
                // Fetch data from the API
                const response = await fetch(fullURL);
                // Throw an error if the response is not OK
                if (!response.ok) {
                    throw new Error('Network response was not ok ' + response.statusText);
                }
                // Parse the JSON data from the response
                const data = await response.json();
                // Return the hits (recipes) from the data
                return data.hits;
            } catch (error) {
                // Log any errors to the console
                console.error('There was a problem with the fetch operation:', error);
            }
        }

        // Call fetchRecipes and render the recipes
        fetchRecipes().then(recipes => {
            // Get the container element where recipes will be displayed
            const container = document.getElementById('recipes-container');
            // Loop through each recipe and create HTML elements to display them
            recipes.forEach(recipe => {
                // Create a div element for each recipe with Bootstrap column class
                const recipeElement = document.createElement('div');
                recipeElement.className = 'col-md-4';
                // Set the inner HTML of the recipe element with card layout
                recipeElement.innerHTML = `
                    <div class="card mb-4">
                        <img src="${recipe.recipe.image}" class="card-img-top" alt="${recipe.recipe.label}">
                        <div class="card-body">
                            <h5 class="card-title">${recipe.recipe.label}</h5>
                            <a href="${recipe.recipe.url}" class="btn btn-primary" target="_blank">View Recipe</a>
                        </div>
                    </div>
                `;
                // Append the recipe element to the container
                container.appendChild(recipeElement);
            });
        });
    </script>
</Layout>
